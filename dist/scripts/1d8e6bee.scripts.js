"use strict";var app=angular.module("frontendApp",[]);app.config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]);var app=angular.module("frontendApp");app.directive("flash",function(){return{restrict:"AE",replace:!0,scope:{message:"="},templateUrl:"views/flash.html",link:function(a,b,c){b.addClass(void 0!=c.type?"alert-"+c.type:"alert-success")}}}),app.factory("Auth",["$http",function(a){var b="http://ng-project-backend.herokuapp.com/session",c={};return c.logged={},c.do=function(){return console.log("do"),a.get(b)},c.login=function(d){return a.post(b,d).then(function(b){return c.logged.status=!0,c.logged.user=d.user,a.defaults.headers.common["auth-token"]=b.data,b.data})},c.logout=function(){return a.delete(b).then(function(){return c.logged.status=!1,c.logged.user=null,delete a.defaults.headers.common["auth-token"],null})},c}]),app.factory("Blogs",["$http",function(a){var b="http://ng-project-backend.herokuapp.com/api/blogs",c={};return c.all=function(){return a.get(b+".json")},c.create=function(c){return console.log("called"),a.post(b+".json",c)},c.delete=function(c){return a.delete(b+"/"+c.id+".json",c)},c}]),app.controller("MainCtrl",["$scope","$http","Blogs","Auth",function(a,b,c,d){a.formVisible=!1,a.loggedIn=d.logged,c.all().success(function(b){a.entries=b}),a.do=function(){d.do().then(function(a){console.log(a.data)})},a.deleteBlog=function(b){c.delete(b).success(function(){var c=a.entries.indexOf(b);a.entries.splice(c,1)})},a.logout=function(){d.logout()},a.login=function(){d.login(a.credentials).then(function(){},function(){}),a.credentials={}},a.createBlog=function(){c.create(a.blog).success(function(b){console.log("luoto"),a.entries.push(b)}),a.flash="A new blog entry '"+a.blog.subject+"'' created",a.formVisible=!1,a.blog={}}}]);